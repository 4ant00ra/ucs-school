# Warning: This file is auto-generated and might be overwritten by 
#          univention-baseconfig.
#          Please edit the following file instead:
# Warnung: Diese Datei wurde automatisch generiert und kann durch 
#          univention-baseconfig Ã¼berschrieben werden. 
#          Bitte bearbeiten Sie an Stelle dessen die folgende Datei:
# 
# 	/etc/univention/templates/files/etc/univention/apache/40ssl
# 


<IfModule mod_ssl.c>
Listen 80
Listen 443
SSLPassPhraseDialog builtin
SSLSessionCache dbm:/var/run/ssl_scache
SSLSessionCacheTimeout 300
SSLMutex file:/var/run/ssl_mutex
SSLRandomSeed startup builtin
SSLRandomSeed connect builtin
</IfModule>

@!@
active_interfaces = []
for i in range(0,4):
	if baseConfig.has_key('interfaces/eth%s/type' % i) and baseConfig['interfaces/eth%s/type' % i] == 'dhcp':
		continue
	if baseConfig.has_key('interfaces/eth%s/address' % i):
		active_interfaces.append(baseConfig['interfaces/eth%s/address' % i])
		
	for j in range(0,4):
		if baseConfig.has_key('interfaces/eth%s_%s/type' % (i,j)) and baseConfig['interfaces/eth%s_%s/type' % (i,j) ] == 'dhcp':
			continue
		if baseConfig.has_key('interfaces/eth%s_%s/address' % (i,j)):
			active_interfaces.append(baseConfig['interfaces/eth%s_%s/address' % (i,j)])
	
if len(active_interfaces) > 0:
	for n in active_interfaces:
		print 'NameVirtualHost %s:443' % n
	
	print '<VirtualHost ',
	for n in active_interfaces:
		print '%s:443' % n,
	print '>'
else:
	print 'NameVirtualHost *:443'
	print ''
	print '<VirtualHost *:443>'
@!@
RewriteEngine On
RewriteOptions inherit

<IfModule mod_ssl.c>
SSLEngine on
SSLCertificateFile /etc/univention/ssl/@%@hostname@%@.@%@domainname@%@/cert.pem
SSLCertificateKeyFile /etc/univention/ssl/@%@hostname@%@.@%@domainname@%@/private.key
#SetEnvIf User-Agent ".*MSIE.*" nokeepalive ssl-unclean-shutdown

# Workaround for IE
# see http://www.modssl.org/docs/2.8/ssl_faq.html#io-ie
SetEnvIf User-Agent ".*MSIE.*" nokeepalive ssl-unclean-shutdown downgrade-1.0 force-response-1.0
#SSLProtocol all -SSLv3
#SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP

</IfModule>
DocumentRoot /usr/share/univention-admin/www
</VirtualHost>

