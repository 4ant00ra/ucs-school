
# grant access to macosx ou by macosx admins
access to dn.regex="^(.+,)?cn=macosx,ou=([^,]+),@%@ldap/base@%@$$"
    by group/univentionGroup/uniqueMember.expand="cn=macosxadmins$2,cn=groups,ou=$2,@%@ldap/base@%@" write
    by * none break

# grant access to macosx user attributes by macosx admins
access to dn.regex="^(.+),cn=users,ou=([^,]+),@%@ldap/base@%@$$" attrs=apple-user-homeurl,apple-user-class,apple-user-homequota,apple-user-mailattribute,apple-user-printattribute,apple-mcxflags,apple-mcxsettings,apple-user-adminlimits,apple-user-picture,apple-user-authenticationhint,apple-user-homesoftquota,apple-user-passwordpolicy,apple-keyword,apple-generateduid,authAuthority,apple-user-homeDirectory filter="(objectClass=apple-user)"
    by group/univentionGroup/uniqueMember.expand="cn=macosxadmins$2,cn=groups,ou=$2,@%@ldap/base@%@" write
    by * none break

# grant access to macosx group attributes by macosx admins
access to dn.regex="^(.+),cn=schueler,cn=groups,ou=([^,]+),@%@ldap/base@%@$$" attrs=apple-group-homeurl,apple-group-homeowner,apple-mcxflags,apple-mcxsettings,apple-group-realname,apple-user-picture,apple-keyword,apple-generateduid,apple-group-memberUid filter="(objectClass=apple-group)" 
    by group/univentionGroup/uniqueMember.expand="cn=macosxadmins$2,cn=groups,ou=$2,@%@ldap/base@%@" write
    by * none break

# grant access to macosx computer attributes by macosx admins
access to dn.regex="^(.+),cn=computers,ou=([^,]+),@%@ldap/base@%@$$" attrs=apple-realname,apple-computer-list-groups,apple-mcxflags,apple-mcxsettings,apple-xmlplist,authAuthority,apple-generateduid
    by group/univentionGroup/uniqueMember.expand="cn=macosxadmins$2,cn=groups,ou=$2,@%@ldap/base@%@" write
    by * none break

